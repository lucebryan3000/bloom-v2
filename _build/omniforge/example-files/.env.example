# ------------------------------------------------------------------------------
# Environment Variables Template (.env.example)
# ------------------------------------------------------------------------------
# Copy to .env.local for local development. Never commit secrets!
# Variables validated at runtime by src/schemas/env.ts (Zod + @t3-oss/env-nextjs)
# Values like APP_NAME, DB_USER are set by bootstrap from bootstrap.conf
# ------------------------------------------------------------------------------

# ==============================================================================
# 1. CORE APPLICATION
# ==============================================================================

# Application identity (set by bootstrap from APP_NAME in bootstrap.conf)
APP_NAME=myapp
NODE_ENV=development

# Public URL (used for callbacks, OAuth redirects, etc.)
NEXT_PUBLIC_APP_URL=http://localhost:3000

# Auth.js callback URL (must match NEXTAUTH_URL for OAuth providers)
# For NextAuth.js v5, this MUST be set for authentication to work
NEXTAUTH_URL=http://localhost:3000/api/auth

# ==============================================================================
# 2. DATABASE (PostgreSQL v16 + Drizzle ORM)
# ==============================================================================

# Connection string for Drizzle and postgres.js
# Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE
# Bootstrap compiles this from DB_NAME, DB_USER, DB_PASSWORD, DB_HOST, DB_PORT in bootstrap.conf
DATABASE_URL=postgresql://dbuser:change_me@localhost:5432/myapp_db

# Individual database parameters (used by bootstrap.conf)
# These are referenced in bootstrap.conf and used to construct DATABASE_URL
# DB_NAME=myapp_db
# DB_USER=dbuser
# DB_PASSWORD=change_me_to_secure_password
# DB_HOST=localhost
# DB_PORT=5432

# Connection pool settings (postgres.js)
DB_POOL_MIN=2
DB_POOL_MAX=20

# pg-boss background job queue
PG_BOSS_SCHEMA=pgboss
JOB_CONCURRENCY=4
JOB_RETENTION_DAYS=7

# ==============================================================================
# 3. AUTHENTICATION (Auth.js v5)
# ==============================================================================

# CRITICAL: Generate a secure secret with: openssl rand -base64 32
# Bootstrap sets this from ENV_AUTH_SECRET in bootstrap.conf
AUTH_SECRET=changeme_to_a_secure_long_random_string

# Session configuration
SESSION_MAX_AGE=604800       # 7 days in seconds
SESSION_UPDATE_AGE=86400     # 1 day in seconds

# Database adapter (Auth.js Drizzle adapter requires DATABASE_URL to be set)
AUTH_TRUST_HOST=true

# OAuth providers (uncomment and configure as needed)
# GITHUB_CLIENT_ID=your_github_client_id
# GITHUB_CLIENT_SECRET=your_github_client_secret
# GOOGLE_CLIENT_ID=your_google_client_id
# GOOGLE_CLIENT_SECRET=your_google_client_secret

# ==============================================================================
# 4. AI/LLM INTEGRATION (@vercel/ai + Anthropic)
# ==============================================================================

# Anthropic API key for Claude models. Never commit the real key!
# Bootstrap sets this from ENV_ANTHROPIC_API_KEY in bootstrap.conf
# Get your key from: https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-changeme_to_your_actual_key

# Model configuration
# AI_DEFAULT_MODEL=claude-sonnet-4-20250514
AI_DEFAULT_MODEL=claude-sonnet-4-20250929
AI_MAX_TOKENS=4096
AI_TEMPERATURE=0.7

# Optional: Custom LLM endpoint (for proxies, local Ollama, etc.)
# LLM_API_BASE_URL=https://api.anthropic.com

# ==============================================================================
# 5. OBSERVABILITY & LOGGING (Pino v8)
# ==============================================================================

# Log level: trace, debug, info, warn, error
LOG_LEVEL=info

# Log format: json (production) or pretty (development)
LOG_FORMAT=pretty

# Optional: External logging service
# LOGTAIL_TOKEN=your_logtail_token
# SENTRY_DSN=your_sentry_dsn

# ==============================================================================
# 6. FEATURE FLAGS & RUNTIME CONFIG
# ==============================================================================

# Core feature toggles (customize per project)
FEATURE_EXPORT_ENABLED=true
FEATURE_PDF_GENERATION_ENABLED=true

# Rate limiting
RATE_LIMIT_REQUESTS=100      # requests per window
RATE_LIMIT_WINDOW_MS=60000   # 1 minute window

# ==============================================================================
# 7. DOCKER & DEPLOYMENT
# ==============================================================================

# Docker Compose configuration (set by bootstrap from APP_NAME in bootstrap.conf)
COMPOSE_PROJECT_NAME=myapp
DOCKER_REGISTRY=localhost:5000
DOCKER_IMAGE_TAG=latest

# Production/Docker database (used by docker-compose.yml and docker-compose.prod.yml)
# Maps to bootstrap.conf DB_* variables when using Docker
POSTGRES_USER=dbuser
POSTGRES_PASSWORD=change_me_to_secure_password
POSTGRES_DB=myapp_db
POSTGRES_HOST_AUTH_METHOD=md5

# ==============================================================================
# 8. DEVELOPMENT-ONLY SETTINGS
# ==============================================================================

# Verbose debug output (Node.js debug module)
DEBUG=*

# Allow dirty git state during bootstrap (development only!)
ALLOW_DIRTY=true

# Auto-seed database on startup (for testing/development)
# SEED_DATABASE=true
# SEED_DATA_PATH=./scripts/seed-data.sql

# Hot reload settings
# WATCHPACK_POLLING=true       # Enable for Docker/VM environments

# ==============================================================================
# NOTES & REFERENCES
# ==============================================================================
#
# HOW TO USE THIS FILE:
# - Copy this file to .env.local for local development
# - Never commit .env.local to git (it's in .gitignore)
# - Use .env.production for production secrets (never committed)
# - For Docker: pass secrets via docker-compose.override.yml or env file
#
# BOOTSTRAP MAPPING:
# This file maps to settings in bootstrap.conf:
#   - APP_NAME: set from bootstrap.conf APP_NAME
#   - DATABASE_URL: constructed from DB_NAME, DB_USER, DB_PASSWORD, DB_HOST, DB_PORT
#   - AUTH_SECRET: set from ENV_AUTH_SECRET reference in bootstrap.conf
#   - ANTHROPIC_API_KEY: set from ENV_ANTHROPIC_API_KEY reference in bootstrap.conf
#   - COMPOSE_PROJECT_NAME: set from bootstrap.conf APP_NAME
#   - POSTGRES_* vars: used by docker-compose when ENABLE_DOCKER=true
#
# REQUIRED VARIABLES FOR STARTUP:
# The application will fail fast at startup if these are missing:
#   - DATABASE_URL (Drizzle ORM)
#   - AUTH_SECRET (Auth.js/NextAuth.js)
#   - NEXTAUTH_URL (Auth.js v5 OAuth callbacks)
#   - ANTHROPIC_API_KEY (if ENABLE_AI_SDK=true in bootstrap.conf)
#
# VALIDATION:
# - All variables are validated at runtime by src/schemas/env.ts
# - Uses Zod + @t3-oss/env-nextjs for type-safe environment access
# - See .env.local.example for additional optional variables
#
# SECURITY BEST PRACTICES:
# 1. Generate AUTH_SECRET: openssl rand -base64 32
# 2. Never commit actual secrets to version control
# 3. Use different values for development, staging, and production
# 4. Rotate secrets periodically in production
# 5. Keep DB_PASSWORD and API keys secure
#
# ==============================================================================
