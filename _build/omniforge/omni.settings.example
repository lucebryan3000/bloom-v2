#!/usr/bin/env bash
# =============================================================================
# omni.settings.example
# Advanced/system settings example for OmniForge.
# Copy to omni.settings.sh and customize.
# =============================================================================

# --- Preflight & Remediation ---
PREFLIGHT_REMEDIATE="true"
PREFLIGHT_SKIP_MISSING="false"
PREFLIGHT_DOWNLOAD_PACKAGES="true"

# --- Auto-Installation ---
AUTO_INSTALL_PNPM="true"
AUTO_INSTALL_NODE="true"
AUTO_INSTALL_DOCKER="true"
AUTO_INSTALL_PSQL="true"

# --- Logging Configuration ---
LOG_LEVEL="status"          # Options: quiet, status, verbose
LOG_FORMAT="plain"          # Options: plain, json
LOG_ROTATE_DAYS="30"
LOG_CLEANUP_DAYS="90"

# --- Docker Configuration ---
ENABLE_DOCKER="true"
DOCKER_EXEC_MODE="container"              # Options: host, container
ENABLE_REDIS="false"
DOCKER_REGISTRY="ghcr.io"
DOCKER_BUILDKIT="1"

# --- Safety & Behavior ---
GIT_SAFETY="true"
ALLOW_DIRTY="false"
NON_INTERACTIVE="false"
MAX_CMD_SECONDS="960"
BOOTSTRAP_RESUME_MODE="skip"              # Options: skip, force

# --- Backup Configuration ---
BACKUP_LOCATION="./backups"
ENABLE_AUTO_BACKUP="true"

# --- Framework & Tool Versions ---
NODE_VERSION="20.18.1"
PNPM_VERSION="9.15.0"
REQUIRED_NODE_VERSION="20"
NEXT_VERSION="15"
POSTGRES_VERSION="16"
PGVECTOR_IMAGE="pgvector/pg16"

# --- Project Structure ---
PROJECT_ROOT="."
OMNIFORGE_DIR="${SCRIPTS_DIR:-_build/omniforge}"
TOOLS_DIR="${PROJECT_ROOT}/.tools"
LOG_DIR="${OMNIFORGE_DIR}/logs"

# --- Installation Directories ---
INSTALL_DIR_TEST="./test/install-1"
INSTALL_DIR_PROD="./app"

# --- Source Directory Structure ---
SRC_DIR="src"
SRC_APP_DIR="${SRC_DIR}/app"
SRC_COMPONENTS_DIR="${SRC_DIR}/components}"
SRC_LIB_DIR="${SRC_DIR}/lib}"
SRC_DB_DIR="${SRC_DIR}/db}"
SRC_STYLES_DIR="${SRC_DIR}/styles}"
SRC_HOOKS_DIR="${SRC_DIR}/hooks}"
SRC_TYPES_DIR="${SRC_DIR}/types}"
SRC_STORES_DIR="${SRC_DIR}/stores}"
SRC_TEST_DIR="${SRC_DIR}/test}"
PUBLIC_DIR="public"
TEST_DIR="__tests__"
E2E_DIR="e2e"

# --- Project Directories List ---
read -r -d '' PROJECT_DIRECTORIES <<'EOF'
${SRC_APP_DIR}
${SRC_COMPONENTS_DIR}
${SRC_LIB_DIR}
${SRC_DB_DIR}
${SRC_STYLES_DIR}
${SRC_HOOKS_DIR}
${SRC_TYPES_DIR}
${PUBLIC_DIR}
EOF

# --- Development Server ---
DEV_PORT="3000"
DEV_SERVER_URL="http://localhost:${DEV_PORT}"

# --- Local Tools Paths ---
NODE_LOCAL_DIR="${TOOLS_DIR}/node"
NODE_LOCAL_BIN="${NODE_LOCAL_DIR}/bin/node"
NPM_LOCAL_BIN="${NODE_LOCAL_DIR}/bin/npm"
NPX_LOCAL_BIN="${NODE_LOCAL_DIR}/bin/npx"
PNPM_LOCAL_DIR="${TOOLS_DIR}/pnpm}"
PNPM_LOCAL_BIN="${PNPM_LOCAL_DIR}/bin/pnpm}"
TOOLS_ACTIVATE_SCRIPT="${PROJECT_ROOT}/.toolsrc"

# --- Node.js Download Configuration ---
NODE_DOWNLOAD_BASE="https://nodejs.org/dist"
NODE_PLATFORM="linux"
NODE_ARCH="x64"

# --- OmniForge Setup Templates ---
OMNIFORGE_EXAMPLE_FILES_DIR="${OMNIFORGE_DIR}/example-files"
TEMPLATE_TOOLSRC="${OMNIFORGE_EXAMPLE_FILES_DIR}/.toolsrc.example"

# --- OmniForge Branding ---
OMNI_VERSION="3.0.0"
OMNI_TAGLINE="Infinite Architectures. Instant Foundation."
OMNI_LOGO="block"

# --- Environment Variable Names ---
ENV_ANTHROPIC_API_KEY="ANTHROPIC_API_KEY"
ENV_AUTH_SECRET="AUTH_SECRET"
ENV_DATABASE_URL="DATABASE_URL"

# Derived values are computed at runtime by lib/bootstrap.sh/config_bootstrap.sh
