#!/usr/bin/env bash
# =============================================================================
# Bootstrap Configuration Template
# =============================================================================
# This is a template. Copy to ../bootstrap.conf to customize your setup.
# All scripts read from bootstrap.conf - NEVER hardcode values in scripts.
#
# Location: _build/bootstrap_scripts/example/bootstrap.conf.example
# Usage:    cp bootstrap.conf.example ../bootstrap.conf
#           Edit ../bootstrap.conf as needed
#           ./run-bootstrap.sh --all
#
# For other configuration templates, see: ./example/ directory
# =============================================================================

# -----------------------------------------------------------------------------
# Core Identity & Paths
# -----------------------------------------------------------------------------

APP_NAME="bloom2"
PROJECT_ROOT="."

# Script locations (self-contained in _build/bootstrap_scripts)
# These are set by run-bootstrap.sh before sourcing this config
# SCRIPT_DIR - Directory where run-bootstrap.sh is located (_build/bootstrap_scripts)
# LOG_DIR - Set to ${SCRIPT_DIR}/logs in run-bootstrap.sh
# Logs directory (created if not exists)
LOGS_DIR="${LOG_DIR}"

# Bootstrap state tracking
BOOTSTRAP_STATE_FILE="${PROJECT_ROOT}/.bootstrap_state"

# -----------------------------------------------------------------------------
# Runtime & Framework Versions
# -----------------------------------------------------------------------------

NODE_VERSION="20"
PNPM_VERSION="9"
NEXT_VERSION="15"
POSTGRES_VERSION="16"
PGVECTOR_IMAGE="pgvector/pgvector:pg16"

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------

DB_NAME="bloom2_db"
DB_USER="bloom2"
DB_PASSWORD="change_me"
DB_PORT="5432"

# -----------------------------------------------------------------------------
# Environment Variable Names (for validation/templates)
# -----------------------------------------------------------------------------

ENV_ANTHROPIC_API_KEY="ANTHROPIC_API_KEY"
ENV_AUTH_SECRET="AUTH_SECRET"
ENV_DATABASE_URL="DATABASE_URL"

# -----------------------------------------------------------------------------
# Feature Flags (Enable/Disable Tech Stacks)
# -----------------------------------------------------------------------------

ENABLE_AUTHJS="true"
ENABLE_AI_SDK="true"
ENABLE_PG_BOSS="true"
ENABLE_SHADCN="true"
ENABLE_ZUSTAND="true"
ENABLE_PDF_EXPORTS="true"
ENABLE_TEST_INFRA="true"
ENABLE_CODE_QUALITY="true"

# -----------------------------------------------------------------------------
# Safety & Global Profiles
# -----------------------------------------------------------------------------

# Git safety: fail if working tree is dirty
GIT_SAFETY="true"
ALLOW_DIRTY="false"

# Stack profiles: full|minimal|api-only
STACK_PROFILE="full"

# CI / non-interactive mode
NON_INTERACTIVE="false"

# Logging format: plain|json
LOG_FORMAT="plain"

# Command timeout (seconds) - 0 or empty means no timeout
MAX_CMD_SECONDS="900"

# Resume behavior: skip|force
BOOTSTRAP_RESUME_MODE="skip"

# -----------------------------------------------------------------------------
# Package Names & Versions
# -----------------------------------------------------------------------------

# Core framework
PKG_NEXT="next@15"
PKG_REACT="react@19"
PKG_REACT_DOM="react-dom@19"
PKG_TYPESCRIPT="typescript@5"
PKG_TYPES_NODE="@types/node@20"
PKG_TYPES_REACT="@types/react@19"
PKG_TYPES_REACT_DOM="@types/react-dom@19"

# DB & ORM
PKG_DRIZZLE_ORM="drizzle-orm"
PKG_DRIZZLE_KIT="drizzle-kit"
PKG_POSTGRES_JS="postgres"
PKG_TSX="tsx"

# AI & Auth
PKG_VERCEL_AI="ai"
PKG_AI_SDK_ANTHROPIC="@ai-sdk/anthropic"
PKG_NEXT_AUTH="next-auth@beta"
PKG_BCRYPTJS="bcryptjs"
PKG_TYPES_BCRYPTJS="@types/bcryptjs"

# State & UI
PKG_ZUSTAND="zustand"
PKG_IMMER="immer"
PKG_CLSX="clsx"
PKG_TAILWIND_MERGE="tailwind-merge"
PKG_REACT_TO_PRINT="react-to-print"

# Jobs & Observability
PKG_PG_BOSS="pg-boss"
PKG_PINO="pino"
PKG_PINO_PRETTY="pino-pretty"

# Validation & Env
PKG_ZOD="zod"
PKG_T3_ENV="@t3-oss/env-nextjs"

# Testing
PKG_VITEST="vitest"
PKG_VITEJS_PLUGIN_REACT="@vitejs/plugin-react"
PKG_TESTING_LIBRARY_REACT="@testing-library/react"
PKG_TESTING_LIBRARY_JEST_DOM="@testing-library/jest-dom"
PKG_JSDOM="jsdom"
PKG_PLAYWRIGHT="@playwright/test"

# Code quality
PKG_ESLINT="eslint"
PKG_ESLINT_CONFIG_PRETTIER="eslint-config-prettier"
PKG_ESLINT_PLUGIN_JSX_A11Y="eslint-plugin-jsx-a11y"
PKG_PRETTIER="prettier"
PKG_HUSKY="husky"
PKG_LINT_STAGED="lint-staged"

# -----------------------------------------------------------------------------
# Package Profiles Per Technology
# -----------------------------------------------------------------------------

AUTH_PACKAGE_PROFILE="core"
AI_PACKAGE_PROFILE="core"
UI_PACKAGE_PROFILE="core"
TEST_PACKAGE_PROFILE="full"
CODE_QUALITY_PACKAGE_PROFILE="full"

# -----------------------------------------------------------------------------
# Script Ordering (defines execution order for default bootstrap)
# -----------------------------------------------------------------------------

BOOTSTRAP_STEPS_DEFAULT="
foundation/init-nextjs.sh
foundation/init-typescript.sh
foundation/init-package-engines.sh
foundation/init-directory-structure.sh
docker/dockerfile-multistage.sh
docker/docker-compose-pg.sh
docker/docker-pnpm-cache.sh
db/drizzle-setup.sh
db/drizzle-schema-base.sh
db/drizzle-migrations.sh
db/db-client-index.sh
env/env-validation.sh
env/zod-schemas-base.sh
env/rate-limiter.sh
env/server-action-template.sh
auth/authjs-setup.sh
auth/auth-routes.sh
ai/vercel-ai-setup.sh
ai/prompts-structure.sh
ai/chat-feature-scaffold.sh
state/zustand-setup.sh
state/session-state-lib.sh
jobs/pgboss-setup.sh
jobs/job-worker-template.sh
observability/pino-logger.sh
observability/pino-pretty-dev.sh
ui/shadcn-init.sh
ui/react-to-print.sh
ui/components-structure.sh
testing/vitest-setup.sh
testing/playwright-setup.sh
testing/test-directory.sh
quality/eslint-prettier.sh
quality/husky-lintstaged.sh
quality/ts-strict-mode.sh
"
